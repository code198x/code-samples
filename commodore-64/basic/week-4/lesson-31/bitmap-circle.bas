10 REM *** BITMAP CIRCLE DEMO ***
20 GOSUB 9000: REM SETUP BITMAP
30 CX=160:CY=100
40 R=20:D=1
999 REM
1000 REM *** MAIN LOOP ***
1010 REM CLEAR PREVIOUS
1020 FOR I = 0 TO 7999
1030 POKE 8192+I, 0
1040 NEXT I
1050 REM DRAW CIRCLE
1060 GOSUB 2000
1070 REM UPDATE RADIUS
1080 R = R + D
1090 IF R > 90 THEN D = -1
1100 IF R < 10 THEN D = 1
1110 FOR T = 1 TO 5: NEXT T
1120 GOTO 1010
1999 REM
2000 REM *** CIRCLE ROUTINE ***
2010 X = 0: Y = R
2020 DD = 1 - R
2030 REM DRAW 8 SYMMETRIC POINTS
2040 GOSUB 3000
2050 IF X >= Y THEN RETURN
2060 IF DD < 0 THEN DD = DD + 2*X + 3: GOTO 2090
2070 DD = DD + 2*(X-Y) + 5
2080 Y = Y - 1
2090 X = X + 1
2100 GOTO 2040
2999 REM
3000 REM *** PLOT 8 POINTS ***
3010 X1=CX+X:Y1=CY+Y:GOSUB 4000
3020 X1=CX-X:Y1=CY+Y:GOSUB 4000
3030 X1=CX+X:Y1=CY-Y:GOSUB 4000
3040 X1=CX-X:Y1=CY-Y:GOSUB 4000
3050 X1=CX+Y:Y1=CY+X:GOSUB 4000
3060 X1=CX-Y:Y1=CY+X:GOSUB 4000
3070 X1=CX+Y:Y1=CY-X:GOSUB 4000
3080 X1=CX-Y:Y1=CY-X:GOSUB 4000
3090 RETURN
3999 REM
4000 REM *** PLOT PIXEL (X1,Y1) ***
4010 IF X1 < 0 THEN RETURN
4020 IF X1 > 319 THEN RETURN
4030 IF Y1 < 0 THEN RETURN
4040 IF Y1 > 199 THEN RETURN
4050 RO = INT(Y1 / 8)
4060 L = Y1 AND 7
4070 CO = INT(X1 / 8)
4080 BI = 7 - (X1 AND 7)
4090 AD = 8192 + RO * 320 + CO * 8 + L
4100 BY = PEEK(AD)
4110 BY = BY OR (2^BI)
4120 POKE AD, BY
4130 RETURN
8999 REM
9000 REM *** BITMAP SETUP ***
9010 PRINT CHR$(147);
9020 POKE 53280,0: POKE 53281,0
9030 REM ENABLE BITMAP
9040 V = PEEK(53265)
9050 V = V OR 32
9060 POKE 53265, V
9070 REM SET BITMAP ADDRESS
9080 V = PEEK(53272)
9090 V = (V AND 15) OR 8
9100 POKE 53272, V
9110 REM SET COLORS
9120 FOR I = 0 TO 999
9130 POKE 1024+I, 15: REM WHITE ON BLACK
9140 NEXT I
9150 REM CLEAR BITMAP
9160 FOR I = 0 TO 7999
9170 POKE 8192+I, 0
9180 NEXT I
9190 RETURN
