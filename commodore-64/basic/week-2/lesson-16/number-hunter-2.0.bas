10 REM *** NUMBER HUNTER 2.0 - LESSON 16 ***
20 REM COMPLETE WEEK 2 DEMONSTRATION
30 REM
40 REM *** ARRAYS ***
50 DIM HS(5)
60 DIM HN$(5)
70 DIM DF$(3)
80 DIM RG(3)
90 DIM GU(3)
100 REM
110 REM *** INITIALIZATION ***
120 POKE 54296, 15
130 GOSUB 9000
140 GOSUB 4000
150 REM *** MAIN LOOP ***
160 GOSUB 3000
170 GOSUB 1000
180 GOSUB 2000
190 GOSUB 3500
200 IF SC <= HS(5) THEN 210
205 GOSUB 4500
210 INPUT "PLAY AGAIN (Y/N)"; A$
220 IF LEFT$(A$, 1) = "Y" THEN 160
230 GOSUB 3700
240 END
1000 REM *** SELECT DIFFICULTY ***
1010 PRINT CHR$(147)
1020 PRINT "SELECT DIFFICULTY:"
1030 PRINT "=================="
1040 PRINT
1050 FOR I = 1 TO 3
1060   PRINT I; ". "; DF$(I)
1070   PRINT "   RANGE: 1-"; RG(I)
1080   PRINT "   GUESSES: "; GU(I)
1090   PRINT
1100 NEXT I
1110 INPUT "CHOICE (1-3)"; CH$
1120 CH = VAL(CH$)
1130 IF CH < 1 THEN GOSUB 5500: GOTO 1110
1135 IF CH > 3 THEN GOSUB 5500: GOTO 1110
1140 GOSUB 5100
1150 RETURN
2000 REM *** PLAY GAME ***
2010 TA = INT(RND(1) * RG(CH)) + 1
2020 GL = GU(CH)
2030 TR = 0
2040 SC = 0
2050 WO = 0
2060 REM
2070 REM *** GAME LOOP ***
2080 PRINT CHR$(147)
2090 GOSUB 3200
2100 PRINT
2110 INPUT "YOUR GUESS"; GU$
2115 IF GU$ = "0" THEN 2130
2120 IF VAL(GU$) = 0 THEN GOSUB 5500: GOTO 2110
2130 GU = VAL(GU$)
2140 TR = TR + 1
2150 GL = GL - 1
2160 REM
2170 IF GU <> TA THEN 2180
2175 WO = 1: GOSUB 5200: RETURN
2180 IF GU >= TA THEN 2200
2190 PRINT "HIGHER!": GOSUB 5300
2195 GOTO 2210
2200 PRINT "LOWER!": GOSUB 5400
2210 FOR I = 1 TO 500: NEXT I
2215 IF GL > 0 THEN 2080
2220 WO = 0: GOSUB 5600: RETURN
3000 REM *** TITLE SCREEN ***
3010 PRINT CHR$(147)
3020 GOSUB 9500
3030 T$ = "NUMBER HUNTER 2.0"
3040 GOSUB 9510
3050 PRINT
3060 T$ = "===================="
3070 GOSUB 9510
3080 PRINT: PRINT
3090 PRINT "  CAN YOU FIND THE SECRET NUMBER?"
3100 PRINT
3110 PRINT "  * MULTIPLE DIFFICULTY LEVELS"
3120 PRINT "  * HIGH SCORE TABLE"
3130 PRINT "  * SOUND EFFECTS"
3140 PRINT
3150 PRINT "PRESS ANY KEY TO START..."
3160 GOSUB 9600
3170 RETURN
3200 REM *** DISPLAY STATUS ***
3210 PRINT "NUMBER HUNTER 2.0"
3220 PRINT "================="
3230 PRINT
3240 PRINT "DIFFICULTY: "; DF$(CH)
3250 PRINT "RANGE: 1 TO "; RG(CH)
3260 PRINT
3270 T$ = "GUESSES LEFT: " + STR$(GL)
3280 T$ = RIGHT$(T$, LEN(T$) - 1)
3290 PRINT T$
3300 PRINT
3310 RETURN
3500 REM *** SHOW RESULTS ***
3510 PRINT CHR$(147)
3520 PRINT
3530 IF WO = 1 THEN PRINT "   *** YOU WON! ***"
3540 IF WO = 0 THEN PRINT "   *** GAME OVER ***"
3550 PRINT
3560 PRINT "THE NUMBER WAS: "; TA
3570 PRINT "YOUR GUESSES: "; TR
3580 PRINT
3590 REM CALCULATE SCORE
3600 IF WO = 0 THEN SC = 0: GOTO 3620
3610 SC = RG(CH) * 10 + (GU(CH) - TR) * 50
3620 PRINT "SCORE: "; SC
3630 PRINT
3640 FOR I = 1 TO 1000: NEXT I
3650 RETURN
3700 REM *** GOODBYE SCREEN ***
3710 PRINT CHR$(147)
3720 PRINT
3730 PRINT "THANKS FOR PLAYING!"
3740 PRINT
3750 PRINT "NUMBER HUNTER 2.0"
3760 PRINT "BY YOUR NAME"
3770 RETURN
4000 REM *** INIT HIGH SCORES ***
4010 FOR I = 1 TO 5
4020   HS(I) = (6 - I) * 100
4030   HN$(I) = "---"
4040 NEXT I
4050 RETURN
4500 REM *** NEW HIGH SCORE ***
4510 PRINT "NEW HIGH SCORE!"
4520 GOSUB 5700
4530 PRINT
4540 PRINT "ENTER YOUR NAME (3 LETTERS):"
4550 INPUT NA$
4560 IF LEN(NA$) <> 3 THEN PRINT "EXACTLY 3 LETTERS!": GOTO 4550
4570 REM VALIDATE LETTERS
4580 VA = 1
4590 FOR I = 1 TO 3
4600   CO = ASC(MID$(NA$, I, 1))
4610   IF CO < 65 THEN VA = 0
4615   IF CO > 90 THEN VA = 0
4620 NEXT I
4630 IF VA = 0 THEN PRINT "LETTERS ONLY!": GOTO 4550
4640 REM FIND POSITION
4650 PO = 0
4660 FOR I = 1 TO 5
4665   IF PO > 0 THEN 4680
4670   IF SC > HS(I) THEN PO = I
4680 NEXT I
4690 REM SHIFT SCORES DOWN
4700 FOR I = 5 TO PO + 1 STEP -1
4710   HS(I) = HS(I - 1)
4720   HN$(I) = HN$(I - 1)
4730 NEXT I
4740 REM INSERT NEW SCORE
4750 HS(PO) = SC
4760 HN$(PO) = NA$
4770 REM DISPLAY TABLE
4780 GOSUB 4800
4790 RETURN
4800 REM *** DISPLAY HIGH SCORES ***
4810 PRINT CHR$(147)
4820 PRINT "HIGH SCORES"
4830 PRINT "==========="
4840 PRINT
4850 FOR I = 1 TO 5
4860   T$ = STR$(I)
4870   T$ = RIGHT$(T$, LEN(T$) - 1)
4880   PRINT T$; ". "; HN$(I); " ... ";
4890   T$ = STR$(HS(I))
4900   T$ = RIGHT$(T$, LEN(T$) - 1)
4910   PRINT T$
4920 NEXT I
4930 PRINT
4940 FOR I = 1 TO 1500: NEXT I
4950 RETURN
5000 REM *** SOUND EFFECTS ***
5100 REM SUCCESS BEEP
5110 POKE 54273, 20: POKE 54272, 0
5120 POKE 54276, 0: POKE 54277, 0
5130 POKE 54275, 65
5140 FOR I = 1 TO 50: NEXT I
5150 POKE 54275, 64
5160 RETURN
5200 REM WIN SOUND
5210 FOR N = 1 TO 8 STEP 2
5220   GOSUB 9700
5230   FOR I = 1 TO 100: NEXT I
5240 NEXT N
5245 RETURN
5300 REM HIGHER HINT
5310 POKE 54273, 15: POKE 54272, 0
5320 POKE 54276, 0: POKE 54277, 0
5330 POKE 54275, 17
5340 FOR I = 1 TO 100: NEXT I
5350 POKE 54275, 16
5360 RETURN
5400 REM LOWER HINT
5410 POKE 54273, 25: POKE 54272, 0
5420 POKE 54276, 0: POKE 54277, 0
5430 POKE 54275, 17
5440 FOR I = 1 TO 100: NEXT I
5450 POKE 54275, 16
5460 RETURN
5500 REM ERROR BEEP
5510 POKE 54273, 10: POKE 54272, 0
5520 POKE 54276, 0: POKE 54277, 0
5530 POKE 54275, 129
5540 FOR I = 1 TO 100: NEXT I
5550 POKE 54275, 128
5560 RETURN
5600 REM LOSE SOUND
5610 FOR F = 30 TO 10 STEP -2
5620   POKE 54273, F: POKE 54272, 0
5630   POKE 54276, 0: POKE 54277, 0
5640   POKE 54275, 17
5650   FOR I = 1 TO 20: NEXT I
5660   POKE 54275, 16
5670 NEXT F
5680 RETURN
5700 REM FANFARE
5710 FOR N = 1 TO 8
5720   GOSUB 9700
5730   FOR I = 1 TO 80: NEXT I
5740 NEXT N
5750 RETURN
9000 REM *** LOAD GAME DATA ***
9010 FOR I = 1 TO 3
9020   READ DF$(I), RG(I), GU(I)
9030 NEXT I
9040 DATA EASY, 10, 5
9050 DATA MEDIUM, 50, 10
9060 DATA HARD, 100, 15
9070 RETURN
9500 REM *** CENTRE TEXT SETUP ***
9510 REM CALL WITH T$ SET
9520 SP = (40 - LEN(T$)) / 2
9530 FOR I = 1 TO SP
9535   PRINT " ";
9540 NEXT I
9550 PRINT T$
9560 RETURN
9600 REM *** WAIT FOR KEY ***
9610 GET K$
9620 IF K$ = "" THEN 9610
9630 RETURN
9700 REM *** PLAY NOTE N ***
9710 RESTORE 9800
9720 FOR I = 1 TO N
9730   READ HI, LO
9740 NEXT I
9750 POKE 54273, HI: POKE 54272, LO
9760 POKE 54276, 0: POKE 54277, 240
9770 POKE 54275, 33
9780 FOR I = 1 TO 50: NEXT I
9790 POKE 54275, 32
9800 DATA 8,179, 9,253, 11,179, 12,131
9810 DATA 14,249, 16,195, 18,209, 21,31
9820 RETURN
