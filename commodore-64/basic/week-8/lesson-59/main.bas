REM *** LESSON 59: ARCADE ACTION GAME ***
REM WOW Moment
NEW
10 REM *** ARCADE BLASTER ***
20 PRINT CHR$(147)
30 POKE 53280,0:POKE 53281,0
40 REM *** INIT ***
50 PX=15:SC=0:LI=3:WV=1:PW=0:PT=0
60 DIM EX(5):DIM EY(5):DIM ET(5)
70 REM *** WAVE START ***
80 FOR I=1 TO 5
90 EX(I)=5+I*5:EY(I)=2
100 IF WV=1 THEN ET(I)=1
110 IF WV=2 THEN ET(I)=1+INT(RND(1)*2)
120 IF WV>=3 THEN ET(I)=1+INT(RND(1)*3)
130 NEXT I
140 BX=-1:BY=-1:PU=0:BO=0
150 IF WV=4 THEN BO=1:BH=10:BX=15:BY=2
160 REM *** MAIN LOOP ***
170 PRINT CHR$(19)
180 PRINT "SCORE:";SC;" LIVES:";LI;" WAVE:";WV
190 IF PW>0 THEN PRINT CHR$(18);" POWER ";CHR$(146);:PT=PT-1:IF PT=0 THEN PW=0
200 PRINT
210 REM *** BOSS ***
220 IF BO=1 THEN PRINT TAB(BX);CHR$(18);"BOSS";CHR$(146);" HP:";BH:GOTO 280
230 REM *** ENEMIES ***
240 FOR I=1 TO 5
250 IF EY(I)>0 THEN PRINT TAB(EX(I));
260 IF ET(I)=1 THEN PRINT "E";
270 IF ET(I)=2 THEN PRINT CHR$(18);"F";CHR$(146);
280 IF ET(I)=3 THEN PRINT "Z";
290 NEXT I
300 REM *** POWER-UP ***
310 IF PU>0 THEN PRINT TAB(15);"P"
320 REM *** BULLET ***
330 IF BY>0 THEN PRINT TAB(BX);"*"
340 REM *** PLAYER ***
350 PRINT TAB(PX);CHR$(18);"A";CHR$(146)
360 REM *** INPUT ***
370 GET K$
380 IF K$="D" AND PX<28 THEN PX=PX+1
390 IF K$="A" AND PX>2 THEN PX=PX-1
400 IF K$=" " AND BY<0 THEN BX=PX:BY=18
410 REM *** BULLET MOVE ***
420 IF BY>0 THEN BY=BY-1
430 IF BY=0 THEN BY=-1
440 REM *** BOSS LOGIC ***
450 IF BO=1 THEN GOSUB 2000:GOTO 550
460 REM *** ENEMY MOVE ***
470 FOR I=1 TO 5
480 IF EY(I)>0 THEN EY(I)=EY(I)+1
490 IF ET(I)=2 THEN EX(I)=EX(I)+INT(RND(1)*3)-1
500 IF ET(I)=3 AND RND(1)<0.3 THEN EX(I)=EX(I)+INT(RND(1)*5)-2
510 IF EX(I)<2 THEN EX(I)=2
520 IF EX(I)>28 THEN EX(I)=28
530 IF EY(I)>19 THEN LI=LI-1:EY(I)=0:IF LI=0 THEN GOTO 3000
540 NEXT I
550 REM *** COLLISION ***
560 FOR I=1 TO 5
570 IF BX=EX(I) AND BY=EY(I) AND EY(I)>0 THEN EY(I)=0:SC=SC+ET(I)*10:BY=-1
580 NEXT I
590 REM *** POWER-UP ***
600 IF PU=0 AND RND(1)<0.02 THEN PU=15
610 IF PU>0 AND PX=15 AND 18=19 THEN PW=1:PT=100:PU=0
620 REM *** WAVE COMPLETE ***
630 W=0:FOR I=1 TO 5:IF EY(I)>0 THEN W=1
640 NEXT I
650 IF W=0 AND BO=0 THEN WV=WV+1:FOR I=1 TO 1000:NEXT I:GOTO 80
660 FOR I=1 TO 50:NEXT I
670 GOTO 170
680 REM
2000 REM *** BOSS BEHAVIOUR ***
2010 BX=BX+INT(RND(1)*5)-2
2020 IF BX<5 THEN BX=5
2030 IF BX>25 THEN BX=25
2040 IF BX=PX AND BY=2 THEN BH=BH-1:BY=-1:IF BH=0 THEN GOSUB 4000
2050 RETURN
2060 REM
3000 REM *** GAME OVER ***
3010 PRINT CHR$(147)
3020 POKE 53280,2:POKE 53281,8
3030 PRINT:PRINT
3040 PRINT "    GAME OVER"
3050 PRINT:PRINT "  FINAL SCORE:";SC
3060 FOR I=1 TO 3000:NEXT I
3070 END
3080 REM
4000 REM *** BOSS DEFEATED ***
4010 PRINT CHR$(147)
4020 POKE 53280,5:POKE 53281,13
4030 PRINT:PRINT
4040 PRINT "  BOSS DEFEATED!"
4050 PRINT:PRINT "  FINAL SCORE:";SC+500
4060 PRINT:PRINT "  YOU WIN!"
4070 FOR I=1 TO 3000:NEXT I
4080 END