REM *** LESSON 60: STRATEGY GAME ***
REM WOW Moment
NEW
10 REM *** TACTICAL COMBAT ***
20 PRINT CHR$(147)
30 POKE 53280,6:POKE 53281,14
40 REM *** INIT ***
50 DIM PT$(3):DIM PH(3):DIM PA(3)
60 DIM ET$(3):DIM EH(3):DIM EA(3)
70 REM *** YOUR UNITS ***
80 PT$(1)="WARRIOR":PH(1)=15:PA(1)=3
90 PT$(2)="ARCHER":PH(2)=10:PA(2)=5
100 PT$(3)="MAGE":PH(3)=8:PA(3)=4
110 REM *** ENEMY UNITS ***
120 ET$(1)="GOBLIN":EH(1)=12:EA(1)=4
130 ET$(2)="SKELETON":EH(2)=8:EA(2)=6
140 ET$(3)="ORC":EH(3)=18:EA(3)=3
150 REM *** MAIN LOOP ***
160 PRINT CHR$(19)
170 PRINT "*** YOUR ARMY ***"
180 FOR I=1 TO 3
190 IF PH(I)>0 THEN PRINT I;": ";PT$(I);" HP:";PH(I);" ATK:";PA(I)
200 IF PH(I)<=0 THEN PRINT I;": ";PT$(I);" [DEAD]"
210 NEXT I
220 PRINT
230 PRINT "*** ENEMY ARMY ***"
240 FOR I=1 TO 3
250 IF EH(I)>0 THEN PRINT I;": ";ET$(I);" HP:";EH(I);" ATK:";EA(I)
260 IF EH(I)<=0 THEN PRINT I;": ";ET$(I);" [DEAD]"
270 NEXT I
280 PRINT
290 REM *** PLAYER TURN ***
300 PRINT "SELECT YOUR UNIT (1-3):"
310 GET K$:IF K$="" THEN GOTO 160
320 U=VAL(K$)
330 IF U<1 OR U>3 OR PH(U)<=0 THEN GOTO 160
340 PRINT CHR$(147)
350 PRINT "UNIT: ";PT$(U)
360 PRINT
370 PRINT "SELECT TARGET (1-3):"
380 FOR I=1 TO 3
390 IF EH(I)>0 THEN PRINT I;": ";ET$(I);" HP:";EH(I)
400 NEXT I
410 PRINT
420 PRINT "4: SPECIAL ABILITY"
430 GET K$:IF K$="" THEN GOTO 340
440 T=VAL(K$)
450 IF T=4 THEN GOSUB 1000:GOTO 600
460 IF T<1 OR T>3 OR EH(T)<=0 THEN GOTO 340
470 REM *** ATTACK ***
480 DM=PA(U)+INT(RND(1)*3)
490 EH(T)=EH(T)-DM
500 PRINT CHR$(147)
510 PRINT PT$(U);" ATTACKS ";ET$(T)
520 PRINT "DAMAGE:";DM
530 IF EH(T)<=0 THEN PRINT ET$(T);" DEFEATED!"
540 FOR I=1 TO 1500:NEXT I
550 REM
600 REM *** ENEMY TURN ***
610 PRINT CHR$(147)
620 PRINT "ENEMY TURN..."
630 FOR I=1 TO 1000:NEXT I
640 REM *** AI SELECTS UNIT ***
650 EU=1+INT(RND(1)*3)
660 IF EH(EU)<=0 THEN GOTO 650
670 REM *** AI SELECTS TARGET ***
680 ET=1+INT(RND(1)*3)
690 IF PH(ET)<=0 THEN GOTO 680
700 REM *** AI ATTACKS ***
710 DM=EA(EU)+INT(RND(1)*3)
720 PH(ET)=PH(ET)-DM
730 PRINT ET$(EU);" ATTACKS ";PT$(ET)
740 PRINT "DAMAGE:";DM
750 IF PH(ET)<=0 THEN PRINT PT$(ET);" DEFEATED!"
760 FOR I=1 TO 1500:NEXT I
770 REM *** WIN CHECK ***
780 PW=0:EW=0
790 FOR I=1 TO 3
800 IF PH(I)>0 THEN PW=1
810 IF EH(I)>0 THEN EW=1
820 NEXT I
830 IF PW=0 THEN GOSUB 2000
840 IF EW=0 THEN GOSUB 3000
850 GOTO 160
860 REM
1000 REM *** SPECIAL ABILITIES ***
1010 PRINT CHR$(147)
1020 IF PT$(U)="WARRIOR" THEN PRINT "SHIELD BASH!":PRINT "+5 HP":PH(U)=PH(U)+5
1030 IF PT$(U)="ARCHER" THEN PRINT "MULTI-SHOT!":PRINT "HIT ALL ENEMIES":FOR I=1 TO 3:EH(I)=EH(I)-2:NEXT I
1040 IF PT$(U)="MAGE" THEN PRINT "FIREBALL!":PRINT "MASSIVE DAMAGE":T=1+INT(RND(1)*3):IF EH(T)>0 THEN EH(T)=EH(T)-8
1050 FOR I=1 TO 1500:NEXT I
1060 RETURN
1070 REM
2000 REM *** DEFEAT ***
2010 PRINT CHR$(147)
2020 POKE 53280,2:POKE 53281,8
2030 PRINT:PRINT
2040 PRINT "   *** DEFEAT ***"
2050 PRINT:PRINT " YOUR ARMY FALLS!"
2060 FOR I=1 TO 3000:NEXT I
2070 END
2080 REM
3000 REM *** VICTORY ***
3010 PRINT CHR$(147)
3020 POKE 53280,5:POKE 53281,13
3030 PRINT:PRINT
3040 PRINT "   *** VICTORY ***"
3050 PRINT:PRINT " ENEMY DEFEATED!"
3060 FOR I=1 TO 3000:NEXT I
3070 END