10 REM Treasure Hunt
20 REM Complete collection game with maze
30 PAPER 0: INK 6: BORDER 1: CLS
40 REM Draw maze border
50 FOR X=0 TO 31
60 PRINT AT 2,X;CHR$ 127
70 PRINT AT 21,X;CHR$ 127
80 NEXT X
90 FOR Y=3 TO 20
100 PRINT AT Y,0;CHR$ 127
110 PRINT AT Y,31;CHR$ 127
120 NEXT Y
130 REM Vertical walls
140 FOR Y=6 TO 18
150 PRINT AT Y,10;CHR$ 127
160 PRINT AT Y,20;CHR$ 127
170 NEXT Y
180 REM Horizontal walls
190 FOR X=5 TO 15
200 PRINT AT 10,X;CHR$ 127
210 NEXT X
220 FOR X=15 TO 25
230 PRINT AT 15,X;CHR$ 127
240 NEXT X
250 REM Create gaps
260 PRINT AT 12,10;" "
270 PRINT AT 15,20;" "
280 PRINT AT 10,12;" "
290 PRINT AT 15,18;" "
300 REM Place treasures
310 INK 3
320 PRINT AT 5,5;"$"
330 PRINT AT 5,25;"$"
340 PRINT AT 18,5;"$"
350 PRINT AT 18,25;"$"
360 PRINT AT 8,15;"$"
370 PRINT AT 17,15;"$"
380 PRINT AT 12,3;"$"
390 PRINT AT 12,28;"$"
400 REM Game variables
410 LET SCORE=0
420 LET ITEMS=8
430 LET MOVES=0
440 REM Display
450 INK 7
460 PRINT AT 0,0;"Treasure Hunt! Q/A/O/P=move"
470 PRINT AT 1,0;"Gold: ";SCORE;"/";ITEMS;" Moves: ";MOVES
480 REM Player start
490 LET PX=15: LET PY=11
500 PRINT AT PY,PX;"@"
510 REM Game loop
520 LET NX=PX: LET NY=PY
530 LET K$=INKEY$
540 IF K$="q" THEN LET NY=NY-1
550 IF K$="a" THEN LET NY=NY+1
560 IF K$="o" THEN LET NX=NX-1
570 IF K$="p" THEN LET NX=NX+1
580 REM Check destination
590 LET CH$=SCREEN$(NY,NX)
600 IF CH$="$" THEN GOSUB 1000
610 IF CH$=" " THEN GOSUB 2000
620 REM Check win
630 IF SCORE=ITEMS THEN GOSUB 3000
640 GO TO 520
1000 REM Collect treasure
1010 PRINT AT PY,PX;" "
1020 LET PX=NX: LET PY=NY
1030 LET SCORE=SCORE+1
1040 LET MOVES=MOVES+1
1050 PRINT AT 1,6;"        "
1060 PRINT AT 1,6;SCORE;"/";ITEMS;" Moves: ";MOVES
1070 INK 7
1080 PRINT AT PY,PX;"@"
1090 BEEP 0.05,15
1100 RETURN
2000 REM Move to empty space
2010 PRINT AT PY,PX;" "
2020 LET PX=NX: LET PY=NY
2030 LET MOVES=MOVES+1
2040 PRINT AT 1,21;MOVES;"  "
2050 PRINT AT PY,PX;"@"
2060 RETURN
3000 REM Win condition
3010 CLS
3020 PAPER 0: INK 6: BRIGHT 1
3030 PRINT AT 8,6;"** TREASURE HUNTER **"
3040 INK 2
3050 PRINT AT 10,8;"All gold collected!"
3060 INK 7
3070 PRINT AT 12,6;"Total moves: ";MOVES
3080 LET EFFICIENCY=INT (MOVES/ITEMS)
3090 PRINT AT 14,4;"Moves per treasure: ";EFFICIENCY
3100 IF EFFICIENCY<10 THEN PRINT AT 16,9;"EXCELLENT!"
3110 IF EFFICIENCY>=10 AND EFFICIENCY<15 THEN PRINT AT 16,11;"GOOD!"
3120 IF EFFICIENCY>=15 THEN PRINT AT 16,13;"TRY AGAIN!"
3130 BEEP 0.3,0: BEEP 0.3,5: BEEP 0.3,10: BEEP 0.3,15
3140 PAUSE 0
3150 STOP
